parameters:
    ###################
    # DATABASE SYSTEM #
    ###################

    project.{{ projectName|lower }}.{{ entityName|lower }}.orm.repository.factory.class: {{ projectName }}\Domain\Service\{{ entityName|capitalize }}\Factory\Orm\RepositoryFactory
    project.{{ projectName|lower }}.{{ entityName|lower }}.odm.repository.factory.class: {{ projectName }}\Domain\Service\{{ entityName|capitalize }}\Factory\Odm\RepositoryFactory
    project.{{ projectName|lower }}.{{ entityName|lower }}.couchdb.repository.factory.class: {{ projectName }}\Domain\Service\{{ entityName|capitalize }}\Factory\CouchDB\RepositoryFactory

    ###################
    #      MANAGER    #
    ###################

    project.{{ projectName|lower }}.{{ entityName|lower }}.manager.{{ group }}.class: {{ projectName }}\Domain\Service\{{ entityName|capitalize }}\Manager\{{ group|capitalize }}\Manager

    ####################
    # WORKFLOW HANDLER #
    ####################

{% for commandQueryResponsibilitySegregation in controllerData %}
    project.{{ projectName|lower }}.{{ entityName|lower }}.{{ commandQueryResponsibilitySegregation.action|lower }}.workflow.handler.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Handler\{{ commandQueryResponsibilitySegregation.action }}WFHandler
{% endfor %}

    ##################
    # WORKFLOW EVENT #
    ##################

    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.valueobject.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFGenerateVOListener
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.many.valueobject.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFGenerateManyVOListener
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.update.phone.valueobject.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFUpdatePhoneVOListener
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.currency.listener.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFGetCurrency
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.entity.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFSaveEntity
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.many.entity.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFSaveManyEntity
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.publish.event.class: {{ projectName }}\Domain\Workflow\{{ entityName|capitalize }}\Observer\WFPublishEvent

    ###################
    # COMMAND HANDLER #
    ###################

{% for commandQueryResponsibilitySegregation in controllerData %}
    project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.class: {{ projectName }}\Application\{{ entityName|capitalize }}\{{ group|capitalize }}\Handler\{{ commandQueryResponsibilitySegregation.action }}{{ group|capitalize }}Handler
{% endfor %}

    #############################
    # COMMAND HANDLER DECORATOR #
    #############################

{% for commandQueryResponsibilitySegregation in controllerData %}
    project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.decorator.class: {{ projectName }}\Application\{{ entityName|capitalize }}\{{ group|capitalize }}\Handler\Decorator\{{ commandQueryResponsibilitySegregation.action }}{{ group|capitalize }}HandlerDecorator
{% endfor %}

    ######################
    # VALIDATION HANDLER #
    ######################

{% for commandQueryResponsibilitySegregation in controllerData %}
    project.{{ projectName|lower }}.{{ entityName|lower }}.validation.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.class: {{ projectName }}\Application\{{ entityName|capitalize }}\{{ group|capitalize }}\Validation\ValidationHandler\{{ commandQueryResponsibilitySegregation.action }}{{ group|capitalize }}ValidationHandler
{% endfor %}

    #################
    # SPECS HANDLER #
    #################

{% for commandQueryResponsibilitySegregation in controllerData %}
    project.{{ projectName|lower }}.{{ entityName|lower }}.spec.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.class: {{ projectName }}\Application\{{ entityName|capitalize }}\{{ group|capitalize }}\Validation\SpecHandler\{{ commandQueryResponsibilitySegregation.action }}{{ group|capitalize }}SpecHandler
{% endfor %}

services:
    ###################
    #     MANAGER     #
    ###################

    #
    # manager Configuration
    # project.{{ projectName|lower }}.{{ entityName|lower }}.repository.factory service is created by CreateRepositoryFactoryPass
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.command.manager:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.manager.command.class%
        arguments:
            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.repository.factory"
        calls:
            - [setLogger, ["@project.dddcontext.logger.domain"]]
            - [addProcess, ["prepersist_create", "@project.{{ projectName|lower }}.{{ entityName|lower }}.new.prepersist.process"]]
            - [addProcess, ["postpersist_create", "@project.{{ projectName|lower }}.{{ entityName|lower }}.new.postpersist.process"]]
            - [addProcess, ["prepersist_update", "@project.{{ projectName|lower }}.{{ entityName|lower }}.new.prepersist.process"]]
            - [addProcess, ["postpersist_update", "@project.{{ projectName|lower }}.{{ entityName|lower }}.new.postpersist.process"]]

    ####################
    # WORKFLOW HANDLER #
    ####################

{% for commandQueryResponsibilitySegregation in controllerData %}
    #
    # {{ commandQueryResponsibilitySegregation.action|lower }} {{ entityName|lower }} workflow handler
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.{{ commandQueryResponsibilitySegregation.action|lower }}.workflow.handler:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.{{ commandQueryResponsibilitySegregation.action|lower }}.workflow.handler.class%
        calls:
          - [addObserver, ["@project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.currency.listener"]]
          - [addObserver, ["@project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.valueobject"]]
          - [addObserver, ["@project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.update.phone.valueobject"]]
          - [addObserver, ["@project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.entity"]]
#          - [addObserver, ["@project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.publish.event"]]

{% endfor %}
    ##################
    # WORKFLOW EVENT #
    ##################

    #
    # new {{ entityName|lower }} Workflow generate VO listener
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.valueobject:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.valueobject.class%

    #
    # new {{ entityName|lower }} Workflow generate Many VO listener
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.many.valueobject:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.generate.many.valueobject.class%

    #
    # new {{ entityName|lower }} Workflow update phone VO listener
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.update.phone.valueobject:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.update.phone.valueobject.class%

    #
    # {{ entityName|lower }} Workflow get currency listener
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.currency.listener:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.currency.listener.class%
        arguments: ["@sfynx.currency.manager", "@sfynx.circuitbreaker"]

    #
    # {{ entityName|lower }} Workflow save entity with doctrine
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.entity:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.entity.class%
        arguments:
            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.command.manager"
        calls:
            - [setLogger, ["@project.dddcontext.logger.domain"]]

    #
    # {{ entityName|lower }} Workflow save Many entity with doctrine
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.many.entity:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.save.many.entity.class%
        arguments:
            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.command.manager"
        calls:
            - [setLogger, ["@project.dddcontext.logger.domain"]]

    #
    # {{ entityName|lower }} Workflow publish event (@TODO)
    #
#    project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.publish.event:
#        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.workflow.publish.event.class%
#        arguments:
#            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.process.manager"
#        calls:
#            - [setLogger, ["@project.dddcontext.logger.domain"]]

    ###################
    # COMMAND HANDLER #
    ###################
{% for commandQueryResponsibilitySegregation in controllerData %}

    #
    # {{ commandQueryResponsibilitySegregation.action|lower }} {{ entityName|lower }} {{ group|capitalize }} handler
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.{{ commandQueryResponsibilitySegregation.action|lower }}.handler:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.class%
        arguments: ["@project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.manager"]

{% endfor %}
    ############################
    # COMMAND HANDLER DECORATOR#
    ############################
{% for commandQueryResponsibilitySegregation in controllerData %}

    #
    # {{ commandQueryResponsibilitySegregation.action|lower }} {{ entityName|lower }} {{ group|capitalize }} handler decorator
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.decorator:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.{{ group }}.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.decorator.class%
        arguments:
            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.command.{{ commandQueryResponsibilitySegregation.action|lower }}.handler"
            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.validation.{{ commandQueryResponsibilitySegregation.action|lower }}.handler"
            - "@project.{{ projectName|lower }}.{{ entityName|lower }}.spec.{{ commandQueryResponsibilitySegregation.action|lower }}.handler"

{% endfor %}
    ######################
    # VALIDATION HANDLER #
    ######################
{% for commandQueryResponsibilitySegregation in controllerData %}

    #
    # {{ commandQueryResponsibilitySegregation.action|lower }} {{ entityName|lower }} {{ group|capitalize }} Validation handler
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.validation.{{ commandQueryResponsibilitySegregation.action|lower }}.handler:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.validation.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.class%
        arguments:
            - "@project.validator.strategy"

{% endfor %}
    #################
    # SPECS HANDLER #
    #################
{% for commandQueryResponsibilitySegregation in controllerData %}

    #
    # {{ commandQueryResponsibilitySegregation.action|lower }} {{ entityName|lower }} {{ group|capitalize }} spec handler
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.spec.{{ commandQueryResponsibilitySegregation.action|lower }}.handler:
        class: %project.{{ projectName|lower }}.{{ entityName|lower }}.spec.{{ commandQueryResponsibilitySegregation.action|lower }}.handler.class%
        calls:
            - [setObject, ["@security.authorization_checker"]]
            - [setLogger, ["@project.dddcontext.logger.application"]]

{% endfor %}
    #################
    #    PROCESS    #
    #################

    #
    # Example of listener on {{ entityName|lower }}.pre.new event
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.new.prepersist.process:
        class: {{ projectName }}\Domain\Service\{{ entityName|capitalize }}\Processor\PrePersistProcess
        calls:
            - [setLogger, ["@project.dddcontext.logger.domain"]]
    #
    # Example of listener on {{ entityName|lower }}.post.new event
    #
    project.{{ projectName|lower }}.{{ entityName|lower }}.new.postpersist.process:
        class: {{ projectName }}\Domain\Service\{{ entityName|capitalize }}\Processor\PostPersistProcess
        calls:
            - [setLogger, ["@project.dddcontext.logger.domain"]]
